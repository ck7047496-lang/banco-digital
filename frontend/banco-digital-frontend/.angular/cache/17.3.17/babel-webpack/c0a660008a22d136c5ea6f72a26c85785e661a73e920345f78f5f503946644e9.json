{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport __NG_CLI_RESOURCE__0 from \"./login.component.html?ngResource\";\nimport __NG_CLI_RESOURCE__1 from \"./login.component.css?ngResource\";\nimport { Component, ViewChild } from '@angular/core';\nimport { FormBuilder, Validators, FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { Router } from '@angular/router';\nimport { UsuarioService } from '../usuario.service';\nimport { CadastroPopupComponent } from '../cadastro-popup/cadastro-popup.component';\nimport { CommonModule } from '@angular/common';\nimport { trigger, state, style, animate, transition } from '@angular/animations';\nimport { jwtDecode } from 'jwt-decode';\nlet LoginComponent = class LoginComponent {\n  router;\n  usuarioService;\n  fb;\n  cadastroPopup;\n  loginForm;\n  errorMessage = '';\n  userType = 'cliente';\n  showPassword = false;\n  constructor(router, usuarioService, fb) {\n    this.router = router;\n    this.usuarioService = usuarioService;\n    this.fb = fb;\n  }\n  ngOnInit() {\n    this.loginForm = this.fb.group({\n      email: ['', [Validators.required, Validators.email]],\n      senha: ['', Validators.required]\n    });\n  }\n  onUserTypeChange() {\n    this.loginForm.controls['email'].setValue('');\n  }\n  togglePasswordVisibility() {\n    this.showPassword = !this.showPassword;\n  }\n  onSubmit() {\n    if (this.loginForm.invalid) {\n      this.errorMessage = 'Por favor, preencha todos os campos corretamente.';\n      return;\n    }\n    const {\n      email,\n      senha\n    } = this.loginForm.value;\n    const userType = this.userType;\n    this.usuarioService.login(email, senha, userType).subscribe({\n      next: response => {\n        if (response && response.token) {\n          localStorage.setItem('token', response.token);\n          const decodedToken = jwtDecode(response.token);\n          const userAuthorities = decodedToken.authorities;\n          if (userAuthorities && userAuthorities.includes('ROLE_GERENTE')) {\n            this.router.navigate(['/painel-gerente']);\n          } else if (userAuthorities && userAuthorities.includes('ROLE_CLIENTE')) {\n            this.usuarioService.verificarStatusUsuario().subscribe({\n              next: usuarioResponse => {\n                if (usuarioResponse.status === 'ATIVO') {\n                  this.router.navigate(['/painel-cliente']);\n                } else {\n                  this.router.navigate(['/aguardando-analise']);\n                }\n              },\n              error: statusErr => {\n                this.errorMessage = statusErr.error?.message || 'Erro ao verificar o status do usuário.';\n              }\n            });\n          } else {\n            this.errorMessage = 'Não foi possível determinar sua permissão de acesso.';\n          }\n        } else {\n          this.errorMessage = 'Credenciais inválidas!';\n        }\n      },\n      error: err => {\n        if (err.status === 401 || err.status === 403) {\n          this.errorMessage = err.error?.message || 'Credenciais inválidas ou cadastro pendente.';\n        } else {\n          this.errorMessage = 'Erro de conexão. Tente novamente mais tarde.';\n        }\n      }\n    });\n  }\n  static ctorParameters = () => [{\n    type: Router\n  }, {\n    type: UsuarioService\n  }, {\n    type: FormBuilder\n  }];\n  static propDecorators = {\n    cadastroPopup: [{\n      type: ViewChild,\n      args: ['cadastroPopup']\n    }]\n  };\n};\nLoginComponent = __decorate([Component({\n  selector: 'app-login',\n  standalone: true,\n  imports: [FormsModule, ReactiveFormsModule, CadastroPopupComponent, CommonModule],\n  template: __NG_CLI_RESOURCE__0,\n  animations: [trigger('loginAnimation', [state('void', style({\n    opacity: 0,\n    transform: 'translateY(-20px)'\n  })), transition(':enter', [animate('0.5s ease-out', style({\n    opacity: 1,\n    transform: 'translateY(0)'\n  }))]), transition(':leave', [animate('0.5s ease-in', style({\n    opacity: 0,\n    transform: 'translateY(-20px)'\n  }))])]), trigger('errorAnimation', [state('void', style({\n    opacity: 0,\n    transform: 'translateX(-10px)'\n  })), transition(':enter', [animate('0.3s ease-out', style({\n    opacity: 1,\n    transform: 'translateX(0)'\n  }))]), transition(':leave', [animate('0.3s ease-in', style({\n    opacity: 0,\n    transform: 'translateX(10px)'\n  }))])])],\n  styles: [__NG_CLI_RESOURCE__1]\n})], LoginComponent);\nexport { LoginComponent };","map":{"version":3,"names":["Component","ViewChild","FormBuilder","Validators","FormsModule","ReactiveFormsModule","Router","UsuarioService","CadastroPopupComponent","CommonModule","trigger","state","style","animate","transition","jwtDecode","LoginComponent","router","usuarioService","fb","cadastroPopup","loginForm","errorMessage","userType","showPassword","constructor","ngOnInit","group","email","required","senha","onUserTypeChange","controls","setValue","togglePasswordVisibility","onSubmit","invalid","value","login","subscribe","next","response","token","localStorage","setItem","decodedToken","userAuthorities","authorities","includes","navigate","verificarStatusUsuario","usuarioResponse","status","error","statusErr","message","err","args","__decorate","selector","standalone","imports","template","__NG_CLI_RESOURCE__0","animations","opacity","transform"],"sources":["c:\\Users\\Clayton\\fullstech\\frontend\\banco-digital-frontend\\src\\app\\login\\login.component.ts"],"sourcesContent":["import { Component, ViewChild, OnInit } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators, FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { Router } from '@angular/router';\r\nimport { UsuarioService } from '../usuario.service';\r\nimport { CadastroPopupComponent } from '../cadastro-popup/cadastro-popup.component';\r\nimport { CommonModule } from '@angular/common';\r\nimport { trigger, state, style, animate, transition } from '@angular/animations';\r\nimport { jwtDecode } from 'jwt-decode';\r\n\r\n@Component({\r\n  selector: 'app-login',\r\n  standalone: true,\r\n  imports: [FormsModule, ReactiveFormsModule, CadastroPopupComponent, CommonModule],\r\n  templateUrl: './login.component.html',\r\n  styleUrls: ['./login.component.css'],\r\n  animations: [\r\n    trigger('loginAnimation', [\r\n      state('void', style({ opacity: 0, transform: 'translateY(-20px)' })),\r\n      transition(':enter', [\r\n        animate('0.5s ease-out', style({ opacity: 1, transform: 'translateY(0)' }))\r\n      ]),\r\n      transition(':leave', [\r\n        animate('0.5s ease-in', style({ opacity: 0, transform: 'translateY(-20px)' }))\r\n      ])\r\n    ]),\r\n    trigger('errorAnimation', [\r\n      state('void', style({ opacity: 0, transform: 'translateX(-10px)' })),\r\n      transition(':enter', [\r\n        animate('0.3s ease-out', style({ opacity: 1, transform: 'translateX(0)' }))\r\n      ]),\r\n      transition(':leave', [\r\n        animate('0.3s ease-in', style({ opacity: 0, transform: 'translateX(10px)' }))\r\n      ])\r\n    ])\r\n  ]\r\n})\r\nexport class LoginComponent implements OnInit {\r\n  @ViewChild('cadastroPopup') cadastroPopup!: CadastroPopupComponent;\r\n\r\n  loginForm!: FormGroup;\r\n  errorMessage: string = '';\r\n  userType: string = 'cliente';\r\n  showPassword = false;\r\n\r\n  constructor(\r\n    private router: Router,\r\n    private usuarioService: UsuarioService,\r\n    private fb: FormBuilder\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.loginForm = this.fb.group({\r\n      email: ['', [Validators.required, Validators.email]],\r\n      senha: ['', Validators.required]\r\n    });\r\n  }\r\n\r\n  onUserTypeChange(): void {\r\n    this.loginForm.controls['email'].setValue('');\r\n  }\r\n\r\n  togglePasswordVisibility(): void {\r\n    this.showPassword = !this.showPassword;\r\n  }\r\n\r\n  onSubmit() {\r\n    if (this.loginForm.invalid) {\r\n      this.errorMessage = 'Por favor, preencha todos os campos corretamente.';\r\n      return;\r\n    }\r\n\r\n    const { email, senha } = this.loginForm.value;\r\n    const userType = this.userType as 'cliente' | 'gerente';\r\n\r\n    this.usuarioService.login(email, senha, userType).subscribe({\r\n      next: (response) => {\r\n        if (response && response.token) {\r\n          localStorage.setItem('token', response.token);\r\n          const decodedToken: any = jwtDecode(response.token);\r\n          const userAuthorities = decodedToken.authorities;\r\n\r\n          if (userAuthorities && userAuthorities.includes('ROLE_GERENTE')) {\r\n            this.router.navigate(['/painel-gerente']);\r\n          } else if (userAuthorities && userAuthorities.includes('ROLE_CLIENTE')) {\r\n            this.usuarioService.verificarStatusUsuario().subscribe({\r\n              next: (usuarioResponse) => {\r\n                if (usuarioResponse.status === 'ATIVO') {\r\n                  this.router.navigate(['/painel-cliente']);\r\n                } else {\r\n                  this.router.navigate(['/aguardando-analise']);\r\n                }\r\n              },\r\n              error: (statusErr) => {\r\n                this.errorMessage = statusErr.error?.message || 'Erro ao verificar o status do usuário.';\r\n              }\r\n            });\r\n          } else {\r\n            this.errorMessage = 'Não foi possível determinar sua permissão de acesso.';\r\n          }\r\n        } else {\r\n          this.errorMessage = 'Credenciais inválidas!';\r\n        }\r\n      },\r\n      error: (err) => {\r\n        if (err.status === 401 || err.status === 403) {\r\n          this.errorMessage = err.error?.message || 'Credenciais inválidas ou cadastro pendente.';\r\n        } else {\r\n          this.errorMessage = 'Erro de conexão. Tente novamente mais tarde.';\r\n        }\r\n      }\r\n    });\r\n  }\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}